@page "/flights"

@*Flight Finder dropdown*@
<h4>Flight Finder</h4>
<div class="d-flex flex-nowrap">

	<div class="w-25" style="margin-right: 10px;">
		<label>From: </label>
		<select class="form-select" @bind="from">
			<option value="Any">Any</option>
			@foreach (Airport airport in airportList)
			{
				<option value="@airport.Code" placeholder="Any">@airport.Name</option>
			}
		</select>
	</div>

	<div class="w-25" style="margin-right: 10px;">
		<label>To: </label>
		<select class="form-select" @bind="to">
			<option value="Any">Any</option>
			@foreach (Airport airport in airportList)
			{
				<option value="@airport.Code" placeholder="Any">@airport.Name</option>
			}
		</select>
	</div>


	<div class="w-25" style="margin-right: 10px;">
		<label>Day:</label>
		<select class="form-select" @bind="filterDay">
			@foreach (string day in days)
			{
				<option>@day</option>
			}
		</select>

	</div>
	<div class="w-25">
		<label></label>
		<button type="submit" class="btn btn-primary w-100" @onclick="Filter">Find Flights</button>
	</div>



</div>


<h4>Flights</h4>

@if (filter == 0)
{
	<select class="form-select">
		<option>Loading...</option>
	</select>
}
else
{
	<select class="form-select" @bind="selected">
		<option disabled selected>Select Flight ...</option>
		@foreach (Flight flight in flights)
		{
			<option>@flight</option>
		}
	</select>
	if(!String.IsNullOrEmpty(selected))
	{
		Select();

	}
}


<h4>Reserve</h4>

<div class="form-group">
	<label>Flight code: </label>
	<input type="text" class="form-control" placeholder="Flight" @bind="fCode" />
</div>

<div class="form-group">
	<label>Airline: </label>
	<input type="text" class="form-control" placeholder="Airline" @bind="fName" />
</div>

<div class="form-group">
	<label>Day: </label>
	<input type="text" class="form-control" placeholder="Day" @bind="fDay" />
</div>

<div class="form-group">
	<label>Time: </label>
	<input type="text" class="form-control" placeholder="Time" @bind="fTime" />
</div>

<div class="form-group">
	<label>Cost: </label>
	<input type="text" class="form-control" placeholder="Cost" @bind="cost" />
</div>

<div class="form-group">
	<label>Name: </label>
	<input type="text" class="form-control" placeholder="Name" @bind="name"/>
</div>

<div class="form-group">
	<label>Citizenship</label>
	<input type="text" class="form-control" placeholder="Citizenship" @bind="citizenship" />
</div>

<button type="submit" class="btn btn-primary" >Reserve</button>

<label>Reservation Code</label>



@code {
	// for dropdown list of airports
	List<Airport> airportList = AirportManager.GetAirports(); 
	AirportManager airportManager = new AirportManager();

	//for dropdown list of days
	string[] days = { "Any", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday" };

	//Filter attributes
	string from = "Any";
	string to="Any";
	string filterDay = "Any";
	int filter = 0;
	List<Flight> flights;

	//Calling the findFlight() method in flightmanager
	private void Filter()
	{
		flights=FlightManager.FindFlights(from, to, filterDay);
		filter++;
	}

	//Adding content to reserve
	string selected=null;
	Flight selectedFlight;
	string fCode;
	string fName;
	string fDay;
	string fTime;
	double cost;
	string name;
	string citizenship;
	private void Select()
	{
		string[] parts = selected.Split(',');
		fCode = parts[0];
		fName = parts[1];
		fDay = parts[4];
		fTime = parts[5];
		cost = Convert.ToDouble(parts[7]);
		selectedFlight = new Flight(parts[0], parts[1], parts[2], parts[3], parts[4], parts[5], Convert.ToInt32(parts[6]), Convert.ToDouble(parts[7]));
	}

}
